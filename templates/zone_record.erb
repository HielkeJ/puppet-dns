<%
data_a = @data.is_a?(String) ? @data.lines.to_a : @data

data_a.each do |data_item|
if %w[TXT SPF].include?(@record.upcase)
  # for TXT and SPF records, transform the data item into a valid text record value:
  # use String.unpack to split the text value into 255 character chunks;
  # then use Array.collect to turn each chunk into a valid quoted character string;
  # finally join the quoted character strings together, separated by a space.
  data_item = data_item.unpack('a255' * ((data_item.length / 255.0).ceil())).collect { |x| '"' + x.gsub(/([\\"])/, '\\\\\\1') + '"' }.join(' ')
end
-%>
<%= @host %>	<%= @ttl %>	<%= @dns_class %>	<%= @record.upcase %><%= @record.upcase == 'MX' ? " #{@preference}" : '' %>	<%= data_item %>
<% end -%>
